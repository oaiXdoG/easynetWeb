# EasyNet Web 项目上手指南

## 1. 启动项目

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 访问 http://localhost:3000
```

---

## 2. 测试账号

| 账号 | 密码 | 角色 |
|------|------|------|
| `superadmin` | `admin123` | 超级管理员（可看到系统管理菜单） |
| `zhangsan` | `123456` | 普通用户（项目管理员） |

---

## 3. 核心逻辑阅读顺序

```
① 入口文件
   src/main.ts                    # 应用初始化、插件注册

② 路由配置
   src/router/index.ts            # 路由定义，了解页面结构
   src/router/guards.ts           # 路由守卫，了解登录拦截逻辑

③ 登录流程
   src/views/Auth/Login.vue       # 登录页面
   src/hooks/auth/index.ts        # useAuth Hook（登录逻辑封装）
   src/stores/auth/index.ts       # authStore（登录状态管理）

④ 菜单渲染
   src/mock/data.ts               # 菜单数据定义（mockProjectMenus）
   src/stores/menu/index.ts       # menuStore（菜单加载逻辑）
   src/components/Layout/AppSidebar.vue  # 侧边栏渲染

⑤ 布局结构
   src/layouts/DefaultLayout.vue  # 页面布局（Header + Sidebar + Main）
   src/components/Layout/AppHeader.vue   # 顶部导航

⑥ 权限控制
   src/stores/permission/index.ts # 权限状态
   src/hooks/permission/index.ts  # usePermission Hook
   src/directives/permission.ts   # v-permission 指令
```

---

## 4. 关键数据流

### 登录流程

```
Login.vue → useAuth.login() → authStore.login() → 设置 token/用户信息
                                    ↓
                           menuStore.loadMenus() → 加载菜单
                                    ↓
                           跳转到 /dashboard
```

### 页面渲染

```
DefaultLayout.vue
    ├── AppHeader.vue (顶部：用户信息、项目切换)
    ├── AppSidebar.vue (侧边栏：从 menuStore 读取菜单)
    └── <router-view> (主内容区)
```

### 菜单数据流

```
mock/data.ts (模拟数据)
       ↓
menuStore.loadMenus() (模拟 API 请求)
       ↓
menuStore.visibleMenuGroups (状态)
       ↓
AppSidebar.vue (渲染菜单)
```

---

## 5. 添加新功能的步骤

### 添加新页面（只需 2 步！）

**步骤 1：修改菜单配置**（src/config/menus.ts）
```typescript
{
  menuCode: 'new_feature',
  menuName: '新功能',
  icon: 'star',              // Material Icons 图标名
  path: '/new/feature',      // 路由路径
  component: 'New/Feature.vue',  // 组件路径（相对于 views）
  sortOrder: 1
}
```

**步骤 2：创建页面组件**（src/views/New/Feature.vue）

**完成！** 路由会自动从菜单配置生成，无需手动修改 router/index.ts

### 添加新 API

1. `src/api/` 下对应模块添加接口
2. `src/mock/data.ts` 添加模拟数据

### 更新菜单权限

修改 `src/mock/data.ts` 中的 menuCodes：
- `mockEcommerceProjectMenuCodes` - 项目可用菜单
- `mockEcommerceAdminMenuCodes` - 角色可用菜单

---

## 6. 建议阅读顺序

| 顺序 | 文件 | 目的 |
|------|------|------|
| 1 | `easynetWeb.md` | 理解设计理念和权限模型 |
| 2 | `docs/目录结构.md` | 了解项目结构 |
| 3 | `src/router/index.ts` | 了解页面结构 |
| 4 | `src/mock/data.ts` | 了解数据结构 |
| 5 | `src/stores/auth/index.ts` | 了解登录逻辑 |
| 6 | `src/stores/menu/index.ts` | 了解菜单加载 |

---

## 7. 核心概念

根据 `easynetWeb.md` 设计文档：

| 概念 | 说明 |
|------|------|
| **账号（User）** | 平台级唯一身份，不直接绑定权限 |
| **项目（Project）** | 业务隔离单元，权限生效边界 |
| **角色（Role）** | 项目内生效，不同项目角色独立 |
| **权限（Permission）** | 行为能力，不是页面/按钮 |

### 权限判断原则

> **在某个项目下，这个账号能不能做这件事**

### 三级权限层级

```
超级管理员（平台级）
    ↓
项目管理员（项目级最高权限）
    ↓
普通用户（权限来源于项目+角色）
```

---

## 8. 技术栈速查

| 类别 | 技术 | 文档 |
|------|------|------|
| 前端框架 | Vue 3 | https://vuejs.org/ |
| 构建工具 | Vite | https://vitejs.dev/ |
| 类型系统 | TypeScript | https://www.typescriptlang.org/ |
| 路由管理 | Vue Router | https://router.vuejs.org/ |
| 状态管理 | Pinia | https://pinia.vuejs.org/ |
| HTTP 客户端 | Axios | https://axios-http.com/ |
| 图标库 | Material Icons | https://fonts.google.com/icons |

---

## 9. 常用命令

```bash
# 开发
npm run dev           # 启动开发服务器

# 构建
npm run build         # 生产构建（含类型检查）

# 类型检查
npx vue-tsc --noEmit  # 仅类型检查，不输出文件
```

---

## 10. 目录结构速览

```
src/
├── api/          # API 接口层（按模块：auth、project、system）
├── stores/       # Pinia 状态管理（按模块组织）
├── hooks/        # 组合式函数（业务逻辑封装）
├── views/        # 页面组件
├── components/   # 公共组件
├── layouts/      # 布局模板
├── router/       # 路由配置
├── directives/   # 自定义指令
├── types/        # TypeScript 类型定义
├── utils/        # 工具函数
├── styles/       # 样式文件
├── mock/         # 模拟数据（严禁硬编码，统一在此管理）
└── assets/       # 静态资源
```

详细说明请参考 `docs/目录结构.md`。
