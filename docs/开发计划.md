# EasynetWeb 开发计划

## 开发阶段总览

| 阶段 | 名称 | 说明 | 状态 |
|------|------|------|------|
| 一 | 基础设施 | 数据库、后端框架、认证 | 进行中 |
| 二 | 前端基础 | 登录、路由、布局 | 未开始 |
| 三 | 超管功能 | 用户管理、项目管理、菜单同步 | 未开始 |
| 四 | 项目功能 | 成员、角色、权限 | 未开始 |
| 五 | 完善优化 | 日志、异常处理、优化 | 未开始 |

---

## 第一阶段：基础设施

### 1.1 数据库初始化

| 状态 | 任务 | 说明 |
|------|------|------|
| [√] | 创建表结构 | 执行 `database/schema.sql` |
| [ ] | 初始化菜单数据 | 执行 `database/seed-menus.sql` |
| [ ] | 初始化超管账号 | 插入默认超管用户 |

**超管初始化 SQL：**
```sql
INSERT INTO sys_user (username, password, real_name, is_super_admin, status)
VALUES ('admin', '${加密后的密码}', '超级管理员', 1, 1);
```

### 1.2 后端基础框架

| 状态 | 任务 | 说明 |
|------|------|------|
| [ ] | 项目框架搭建 | 目录结构、依赖配置 |
| [ ] | 数据库连接 | 数据源配置 |
| [ ] | 统一响应结构 | ApiResponse |
| [ ] | 统一异常处理 | 全局异常处理 |
| [ ] | 工具类 | 密码加密、Token生成 |

**响应结构体：**
```java
public class ApiResponse<T> {
    private Integer code;
    private String message;
    private T data;
}
```

### 1.3 认证模块

| 状态 | 任务 | API |
|------|------|-----|
| [ ] | 登录接口 | POST /api/auth/login |
| [ ] | 登出接口 | POST /api/auth/logout |
| [ ] | 获取当前用户 | GET /api/auth/me |
| [ ] | Token验证中间件 | - |

**登录请求/响应：**
```java
// 请求
public class LoginRequest {
    private String username;
    private String password;
}

// 响应
public class LoginResponse {
    private String token;
    private UserInfo userInfo;
}

public class UserInfo {
    private Long id;
    private String username;
    private String realName;
    private String avatar;
    private Boolean isSuperAdmin;
}
```

---

## 第二阶段：前端基础

### 2.1 登录功能

| 状态 | 任务 | 文件 |
|------|------|------|
| [ ] | 登录页面 | src/views/Login.vue |
| [ ] | 登录API对接 | src/api/auth.ts |
| [ ] | Token存储 | src/utils/auth.ts |
| [ ] | 用户状态管理 | src/stores/auth.ts |

### 2.2 路由守卫

| 状态 | 任务 | 说明 |
|------|------|------|
| [ ] | 登录检查 | 无Token跳转登录页 |
| [ ] | 用户信息获取 | 获取当前用户信息 |
| [ ] | 超管/普通用户分流 | 根据 is_super_admin 跳转 |

### 2.3 基础布局

| 状态 | 任务 | 说明 |
|------|------|------|
| [ ] | 超管布局 | 系统管理菜单 |
| [ ] | 普通用户布局 | 项目菜单 + 项目切换 |
| [ ] | 空状态页面 | 无项目时的提示页 |

---

## 第三阶段：超管功能

### 3.1 账号管理

| 状态 | 任务 | API |
|------|------|-----|
| [ ] | 用户列表 | GET /api/users |
| [ ] | 创建用户 | POST /api/users |
| [ ] | 编辑用户 | PUT /api/users/{id} |
| [ ] | 删除用户 | DELETE /api/users/{id} |
| [ ] | 启用/禁用 | PUT /api/users/{id}/status |
| [ ] | 前端页面 | src/views/System/User.vue |

**用户实体：**
```java
public class SysUser {
    private Long id;
    private String username;
    private String password;
    private String email;
    private String phone;
    private String realName;
    private String avatar;
    private Integer isSuperAdmin;
    private Integer status;
    private LocalDateTime lastLoginAt;
    private LocalDateTime createdAt;
    private LocalDateTime updatedAt;
}
```

### 3.2 项目管理

| 状态 | 任务 | API |
|------|------|-----|
| [ ] | 项目列表 | GET /api/projects |
| [ ] | 创建项目 | POST /api/projects |
| [ ] | 编辑项目 | PUT /api/projects/{id} |
| [ ] | 删除项目 | DELETE /api/projects/{id} |
| [ ] | 配置项目菜单 | PUT /api/projects/{id}/menus |
| [ ] | 分配用户到项目 | POST /api/projects/{id}/users |
| [ ] | 前端页面 | src/views/System/Project.vue |

**项目实体：**
```java
public class SysProject {
    private Long id;
    private String projectName;
    private String description;
    private Long ownerId;
    private Integer status;
    private Long createdBy;
    private LocalDateTime createdAt;
    private LocalDateTime updatedAt;
}
```

### 3.3 菜单同步

| 状态 | 任务 | API |
|------|------|-----|
| [ ] | 同步菜单接口 | POST /api/admin/menus/sync |
| [ ] | 获取所有菜单 | GET /api/admin/menus |
| [ ] | 前端同步按钮 | src/views/System/Project.vue |

**同步请求/响应：**
```java
// 请求
public class SyncMenusRequest {
    private List<MenuGroupDTO> groups;
    private List<MenuItemDTO> menus;
}

// 响应
public class SyncMenusResponse {
    private Integer groupsAdded;
    private Integer groupsUpdated;
    private Integer groupsDeleted;
    private Integer menusAdded;
    private Integer menusUpdated;
    private Integer menusDeleted;
}
```

---

## 第四阶段：项目功能

### 4.1 项目上下文

| 状态 | 任务 | API |
|------|------|-----|
| [ ] | 获取用户项目列表 | GET /api/my/projects |
| [ ] | 切换当前项目 | POST /api/my/current-project |
| [ ] | 获取当前项目信息 | GET /api/my/current-project |

**项目上下文响应：**
```java
public class ProjectContext {
    private Long projectId;
    private String projectName;
    private Long roleId;
    private String roleName;
    private List<String> menuCodes;      // 可见菜单
    private List<String> permissions;    // 操作权限
}
```

### 4.2 成员管理

| 状态 | 任务 | API |
|------|------|-----|
| [ ] | 成员列表 | GET /api/projects/{id}/members |
| [ ] | 添加成员 | POST /api/projects/{id}/members |
| [ ] | 移除成员 | DELETE /api/projects/{id}/members/{userId} |
| [ ] | 修改成员角色 | PUT /api/projects/{id}/members/{userId}/role |
| [ ] | 前端页面 | src/views/Project/Member.vue |

### 4.3 角色管理

| 状态 | 任务 | API |
|------|------|-----|
| [ ] | 角色列表 | GET /api/projects/{id}/roles |
| [ ] | 创建角色 | POST /api/projects/{id}/roles |
| [ ] | 编辑角色 | PUT /api/projects/{id}/roles/{roleId} |
| [ ] | 删除角色 | DELETE /api/projects/{id}/roles/{roleId} |
| [ ] | 配置角色菜单 | PUT /api/projects/{id}/roles/{roleId}/menus |
| [ ] | 配置角色权限 | PUT /api/projects/{id}/roles/{roleId}/permissions |
| [ ] | 前端页面 | src/views/Project/Role.vue |

**角色实体：**
```java
public class SysRole {
    private Long id;
    private Long projectId;
    private String roleName;
    private String description;
    private Integer status;
    private LocalDateTime createdAt;
    private LocalDateTime updatedAt;
}
```

### 4.4 权限管理

| 状态 | 任务 | API |
|------|------|-----|
| [ ] | 权限列表 | GET /api/projects/{id}/permissions |
| [ ] | 创建权限 | POST /api/projects/{id}/permissions |
| [ ] | 编辑权限 | PUT /api/projects/{id}/permissions/{permId} |
| [ ] | 删除权限 | DELETE /api/projects/{id}/permissions/{permId} |
| [ ] | 前端页面 | src/views/Project/Permission.vue |

**权限实体：**
```java
public class SysPermission {
    private Long id;
    private Long projectId;
    private String permissionCode;
    private String permissionName;
    private String description;
    private Integer status;
    private LocalDateTime createdAt;
    private LocalDateTime updatedAt;
}
```

---

## 第五阶段：完善优化

### 5.1 操作日志

| 状态 | 任务 | 说明 |
|------|------|------|
| [ ] | 日志记录中间件 | 记录API操作 |
| [ ] | 日志查询接口 | GET /api/logs |
| [ ] | 日志查询页面 | - |

### 5.2 其他优化

| 状态 | 任务 | 说明 |
|------|------|------|
| [ ] | 删除前端Mock数据 | 清理测试数据 |
| [ ] | 错误处理优化 | 友好的错误提示 |
| [ ] | 性能优化 | 分页、缓存等 |

---

## 当前进度

**已完成：**
- [√] 数据库表结构设计（11张表）
- [√] 架构设计文档
- [√] 后端实体类（entity）
- [√] 后端请求响应结构体（protocol）

**下一步：**
- [ ] 1.2 后端基础框架（数据库连接、统一异常处理、工具类）
- [ ] 1.3 认证模块（登录、登出、Token验证）

---

## 更新记录

| 日期 | 更新内容 |
|------|----------|
| 2025-12-25 | 创建开发计划，整理开发阶段 |
| 2025-12-25 | 完成后端 entity 和 protocol 结构体 |
