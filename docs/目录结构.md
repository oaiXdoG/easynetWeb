# EasyNet Web 项目目录结构说明

## 整体目录结构

```
src/
├── api/                    # API 接口层
│   ├── auth/               # 认证相关 API
│   ├── project/            # 项目相关 API
│   ├── system/             # 系统管理 API
│   ├── index.ts            # API 统一导出
│   └── request.ts          # Axios 请求封装
│
├── config/                 # 前端配置
│   └── menus.ts            # 平台全量菜单配置
│
├── stores/                 # Pinia 状态管理
│   ├── auth/               # 认证状态
│   ├── project/            # 项目状态
│   ├── permission/         # 权限状态
│   ├── menu/               # 菜单状态
│   ├── app/                # 应用全局状态
│   └── index.ts            # Store 统一导出
│
├── hooks/                  # 组合式函数（Composables）
│   ├── auth/               # 认证相关 Hook
│   ├── project/            # 项目相关 Hook
│   ├── permission/         # 权限相关 Hook
│   └── index.ts            # Hooks 统一导出
│
├── views/                  # 页面组件
│   ├── Auth/               # 认证页面
│   ├── Dashboard/          # 控制台首页
│   ├── System/             # 系统管理
│   ├── Project/            # 项目设置
│   ├── Log/                # 日志中心
│   └── Error/              # 错误页面
│
├── components/             # 公共组件
│   ├── Layout/             # 布局组件
│   └── Permission/         # 权限组件
│
├── layouts/                # 布局模板
│   └── DefaultLayout.vue   # 默认布局
│
├── router/                 # 路由配置
│   ├── index.ts            # 路由定义
│   └── guards.ts           # 路由守卫
│
├── directives/             # 自定义指令
│   └── permission.ts       # v-permission 权限指令
│
├── types/                  # TypeScript 类型定义
│   └── index.ts            # 全局类型
│
├── utils/                  # 工具函数
│   └── storage.ts          # 本地存储封装
│
├── styles/                 # 样式文件
│   ├── layout/             # 布局样式
│   └── views/              # 页面样式
│       ├── auth/
│       ├── error/
│       ├── project/
│       └── system/
│
├── mock/                   # 模拟数据
│   └── data.ts             # Mock 数据
│
├── assets/                 # 静态资源
├── App.vue                 # 根组件
├── main.ts                 # 应用入口
└── vite-env.d.ts           # Vite 环境类型
```

---

## 各目录详细说明

### 1. api/ - API 接口层

按模块封装后端 API 调用，统一管理请求逻辑。

| 子目录/文件 | 用途 |
|-------------|------|
| `auth/` | 认证相关 API（登录、登出、Token 刷新） |
| `project/` | 项目相关 API（项目切换、项目信息获取） |
| `system/` | 系统管理 API（用户管理、项目管理-超管功能） |
| `index.ts` | API 模块统一导出 |
| `request.ts` | Axios 实例封装，包含请求/响应拦截器 |

---

### 2. config/ - 前端配置

前端静态配置，不依赖后端。

| 文件 | 用途 |
|------|------|
| `menus.ts` | 平台全量菜单配置（菜单名称、图标、路径），详见 `docs/菜单权限设计.md` |

---

### 3. stores/ - Pinia 状态管理

使用 Pinia 进行全局状态管理，按模块组织。

| 子目录 | 用途 |
|--------|------|
| `auth/` | 认证状态（token、用户信息、登录状态、用户项目列表） |
| `project/` | 项目状态（当前项目上下文、项目切换、项目信息） |
| `permission/` | 权限状态（权限列表、权限检查方法） |
| `menu/` | 菜单状态（根据 visibleMenuCodes 过滤 platformMenus） |
| `app/` | 应用全局状态（loading、主题等通用状态） |

---

### 3. hooks/ - 组合式函数

封装可复用的业务逻辑，供组件调用。Hooks 是对 Store 的进一步封装，提供更便捷的 API。

| 子目录 | 用途 |
|--------|------|
| `auth/` | 认证相关 Hook（登录、登出、状态检查、自动加载菜单） |
| `project/` | 项目相关 Hook（项目切换、初始化默认项目） |
| `permission/` | 权限相关 Hook（权限检查、超管判断、批量权限检查） |

---

### 4. views/ - 页面组件

路由对应的页面级组件，按功能模块组织。

| 子目录 | 用途 |
|--------|------|
| `Auth/` | 认证页面（登录页） |
| `Dashboard/` | 控制台首页 |
| `System/` | 系统管理（用户管理、项目管理 - 超管功能） |
| `Project/` | 项目设置（成员管理、角色管理、权限配置） |
| `Log/` | 日志中心（游戏日志、服务器日志） |
| `Error/` | 错误页面（403 无权限、404 未找到） |

---

### 5. components/ - 公共组件

可复用的 UI 组件。

| 子目录 | 用途 |
|--------|------|
| `Layout/` | 布局组件（AppHeader 顶部导航、AppSidebar 侧边栏 - 从 menuStore 读取菜单） |
| `Permission/` | 权限组件（权限指令的组件封装） |

---

### 6. layouts/ - 布局模板

页面布局结构模板。

| 文件 | 用途 |
|------|------|
| `DefaultLayout.vue` | 默认布局（Header + Sidebar + Main 三栏布局） |

---

### 7. router/ - 路由配置

Vue Router 路由配置。

| 文件 | 用途 |
|------|------|
| `index.ts` | 路由定义（静态路由、认证路由、嵌套路由） |
| `guards.ts` | 路由守卫（登录检查、权限验证） |

---

### 8. directives/ - 自定义指令

Vue 自定义指令。

| 文件 | 用途 |
|------|------|
| `permission.ts` | v-permission 权限指令，用于控制元素显示 |

---

### 9. types/ - TypeScript 类型定义

全局 TypeScript 接口和类型定义。

| 文件 | 用途 |
|------|------|
| `index.ts` | 统一导出所有类型 |
| `menu.ts` | 菜单类型（MenuTreeNode、SidebarMenuItem、SidebarMenuGroup） |
| `auth.ts` | 认证类型（LoginParams、LoginResult、TokenInfo） |
| `user.ts` | 用户类型（User） |
| `project.ts` | 项目类型（Project、CurrentProjectContext） |
| `role.ts` | 角色类型（Role） |
| `permission.ts` | 权限类型（Permission） |
| `api.ts` | API 通用类型（ApiResponse、PageResult） |

---

### 10. utils/ - 工具函数

通用工具方法。

| 文件 | 用途 |
|------|------|
| `storage.ts` | 本地存储封装（localStorage、Token 管理） |

---

### 11. styles/ - 样式文件

CSS/SCSS 样式文件，按模块组织。

| 子目录 | 用途 |
|--------|------|
| `layout/` | 布局相关样式 |
| `views/auth/` | 认证页面样式 |
| `views/error/` | 错误页面样式 |
| `views/project/` | 项目设置页面样式 |
| `views/system/` | 系统管理页面样式 |

---

### 12. mock/ - 模拟数据

开发阶段的 Mock 数据，**严禁在组件中硬编码数据**。

| 文件 | 用途 |
|------|------|
| `data.ts` | 模拟登录响应、项目数据、菜单数据等 |

#### Mock 数据结构

```typescript
// 侧边栏菜单数据
mockProjectMenus        // 普通用户菜单（控制台、日志、项目设置）
mockSuperAdminMenus     // 超级管理员额外菜单（系统管理）

// API 响应模拟
mockLoginResponse       // 登录响应
mockSwitchProjectResponse // 切换项目响应
mockGetMenusResponse    // 获取菜单响应
```

---

### 13. assets/ - 静态资源

图片、字体等静态文件。

---

## 目录组织原则

1. **按模块功能区分**：`api/`、`stores/`、`hooks/` 等目录内部按业务模块（auth、project、system）组织
2. **统一导出**：每个目录都有 `index.ts` 文件统一导出，方便引用
3. **职责分离**：
   - `api/` 负责 HTTP 请求
   - `stores/` 负责状态管理
   - `hooks/` 负责业务逻辑封装
   - `views/` 负责页面渲染
4. **样式隔离**：样式文件按页面模块组织，避免样式冲突
5. **严禁硬编码**：所有模拟数据统一放在 `mock/` 目录，组件通过 Store 获取数据

---

## 数据流设计

### 菜单数据流

```
config/menus.ts (前端定义全量菜单)
       +
mock/data.ts (后端返回 visibleMenuCodes)
       ↓
menuStore.loadMenus()
       ↓
menuStore.filteredMenus (根据 menuCode 过滤)
       ↓
AppSidebar.vue (渲染菜单)
```

### 添加新菜单

1. 修改 `src/config/menus.ts` 添加菜单定义
2. 修改 `src/router/index.ts` 添加路由
3. 创建页面组件

详见 `docs/菜单权限设计.md`。

---

## 引用示例

```typescript
// 引用 Store
import { useAuthStore, useProjectStore } from '@/stores'

// 引用 Hook
import { useAuth, usePermission } from '@/hooks'

// 引用 API
import { authApi, projectApi } from '@/api'

// 引用类型
import type { User, Project } from '@/types'
```
